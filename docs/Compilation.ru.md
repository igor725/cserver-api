# Компиляция

## Скачивание исходников

Для начала необходимо создать папку. 

В выбранную папку склонируйте сервер вместе с любыми плагинами которые хотите.

Например, если вам нужен Lua плагин, вы можете использовать:

```bash
git clone https://github.com/igor725/cserver &&
git clone https://github.com/igor725/cs-base &&
git clone https://github.com/igor725/cs-lua 
```

Когда вы введете команды выше, ваши папки будут расположены таким образом:

```
./server_src        - Root folder
    cserver/        - Server source
    cs-lua/         - Lua plugin source
```

## Компиляция

Чтобы скомпилировать сервер (с плагинами, если имеются), пропишите ``cd`` в директорию ``cserver``, и используйте скрипт ``build``.

Ниже предоставлены аргументы, которые могут быть переданы в ``build`` скрипт:

| Аргумент  | Описание                                                              |
|-----------|-----------------------------------------------------------------------|
| cls       | Очистить терминал перед компиляцией                                   |
| upd       | Обновить репозиторий сервера(или плагина) перед компиляцией           |
| dbg       | Собрать с информацией для дебаггера                                   |
| wall      | Включить всевозможные предупреждения.                                 |
| wx        | Обработка предупрждений как ошибок.                                   |
| w0        | Отключить все предупреждения.                                         |
| od        | Выключить оптимизацию компилятора.                                    |
| san       | Включить санитайзер адресов.                                          |
| run       | Запустить сервер сразу после компиляции                               |
| runsame   | Запустить сервер сразу после компиляции в этом же окне (Только Windows)|
| noprompt  | Автоматически скачать zlib (Только для Windows)                       |
| pb        | Скомпилировать плагин (Ниже подробности)                              |

C аргументом ``pb``, скрипт скомпилирует плагин с заданными ему именем и аргументами. Не указывайте
имя начиная с ``cs-``. Например ``build pb lua``, вместо ``build pb cs-lua``.

| Аргумент | Описание                                       |
|----------|------------------------------------------------|
| install  | Копирует плагин в папку ``plugins``.           |

Плагины могут задавать свои собственные аргументы, поэтому рекомендуется смотреть ``vars`` файл.

### Аргументы cs-lua

| Argument | Description                                                    |
|----------|----------------------------------------------------------------|
| jit2     | Выбрать [LuaJIT 2](https://github.com/openresty/luajit2).       |
| jit      | Выбрать [LuaJIT](https://github.com/luajit/luajit).             |
| 54       | Выбрать [Lua 5.4](https://www.lua.org/ftp/lua-5.4.4.tar.gz).    |
| 53       | Выбрать [Lua 5.3](https://www.lua.org/ftp/lua-5.3.6.tar.gz).    |
| 52       | Выбрать [Lua 5.2](https://www.lua.org/ftp/lua-5.2.4.tar.gz).    |
| 51       | Выбрать [Lua 5.1](https://www.lua.org/ftp/lua-5.1.5.tar.gz).    |

Вы можете скомпилировать сервер и Lua плагин, используя следующие комманды:

```bash
./build upd &&
./build upd pb lua install &&
./build upd pb base install
```

Вы можете запустить бинарники сервера в ``./out/%SYSTEM ARCHITECTURE%/``.

## Заметки

* Строго рекомендуется перекомпилировать все плагины каждый раз при обновлении сервера.
* По умолчанию, сервер не имеет обширного количества базовых комманд. Скомпилируйте [cs-base](https://github.com/igor725/cs-base) плагин для расширения возможностей. 
